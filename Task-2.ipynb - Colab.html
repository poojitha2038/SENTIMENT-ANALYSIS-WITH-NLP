# Step 1: Import Libraries
import pandas as pd
import numpy as np
import re
import string
from sklearn.model_selection import train_test_split
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score, classification_report, confusion_matrix
import seaborn as sns
import matplotlib.pyplot as plt

# Step 2: Sample Dataset (You can replace with real reviews dataset)
data = {
    "Review": [
        "I love this product, itâ€™s amazing!",
        "Worst experience ever, I hate it.",
        "Very good quality, highly recommend.",
        "Terrible service, not happy at all.",
        "The item was decent, nothing special.",
        "Absolutely fantastic! Worth the price.",
        "Bad quality and late delivery.",
        "Great support and fast shipping.",
        "I am disappointed with this purchase.",
        "Superb! I will buy again."
    ],
    "Sentiment": [
        "Positive", "Negative", "Positive", "Negative", "Neutral",
        "Positive", "Negative", "Positive", "Negative", "Positive"
  ]
}

df = pd.DataFrame(data)

# Step 3: Preprocess Text
def preprocess_text(text):
    text = text.lower()  # lowercase
    text = re.sub(r"http\S+", "", text)  # remove URLs
    text = text.translate(str.maketrans("", "", string.punctuation))  # remove punctuation
    text = re.sub(r"\d+", "", text)  # remove numbers
    text = text.strip()  # remove extra spaces
    return text

df["Cleaned_Review"] = df["Review"].apply(preprocess_text)

print("Sample Preprocessed Data:\n", df.head())

# Step 4: Split Data
X = df["Cleaned_Review"]
y = df["Sentiment"]

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.25, random_state=42
)

# Step 5: TF-IDF Vectorization
tfidf = TfidfVectorizer(max_features=500, stop_words="english")
X_train_tfidf = tfidf.fit_transform(X_train)
X_test_tfidf = tfidf.transform(X_test)

print("Shape of Training Data:", X_train_tfidf.shape)
print("Shape of Testing Data:", X_test_tfidf.shape)

# Step 6: Train Logistic Regression
model = LogisticRegression()
model.fit(X_train_tfidf, y_train)

# Step 7: Predictions
y_pred = model.predict(X_test_tfidf)

# Step 8: Evaluation
print("\nModel Accuracy:", accuracy_score(y_test, y_pred))
print("\nClassification Report:\n", classification_report(y_test, y_pred))

# Confusion Matrix
cm_labels = sorted(list(set(y_test) | set(y_pred)))
cm = confusion_matrix(y_test, y_pred, labels=cm_labels)
sns.heatmap(cm, annot=True, fmt="d", cmap="Blues",
            xticklabels=cm_labels,
            yticklabels=cm_labels)
plt.title("Confusion Matrix")
plt.xlabel("Predicted")
plt.ylabel("Actual")
plt.show()
